# (15)VPCの構築

## 本章の目的：

- VPCやサブネットとは何かを学ぶ。
- VPCとインターネットとの接続方法を学ぶ。

***

通常、ネットワークは複数の単位に分割されます。理由は、全てのサーバやPC、各種デバイスを１つのネットワークにまとめると、一括管理をするのが難しくなるからです。また障害発生時の影響も大きくなリます。

複数に分けたネットワーク1つ1つを**サブネット**といいます。サブネットを上手に活用し、部署やフロアごとにサブネットを分けたり、インターネットから接続できるサブネットとできないできないサブネットに分けてセキュリティを担保する、といったことができます。

このような内容は、12章で解説しました。不安のある方は12章をもう一度目を通しておくことをオススメします。

本章では、実際に**AWS VPC(Virtual Private Cloud)を構築し、その中にサブネットを立ち上げます。**

### 1. 今回構築するVPCの構成

まずはじめに、今回構築するVPCの全容をご確認ください。

＜図１：VPCの全体像＞

この全体像をもとに、VPCやサブネットの構築方法を解説します。以降は、この全体像を見ながら読んでください。

#### 1-1. VPC

**AWS VPCは、仮想ネットワークを構築するAWSのサービスです。**こういってしまえばそれまでですが、ここではとりあえず「今回構築するネットワーク全体」と理解してください。最初にVPCを作り、その中に要件に従ったサブネットを順次立ち上げていきます。

VPC内にインターネット回線を引き込むために**インターネットゲートウェイ**を置きます。このインターネットゲートウェイにサブネットを接続（アタッチ）すると、インターネットとサブネット内のサーバインスタンスが繋がります。ちょっとややこしいので、全体像を見ながら以下の流れを理解してください。

インターネット → 
    インターネットゲートウェイ → 
        サブネット →
            サブネット内のサーバインスタンス

#### 1-2. インターネットゲートウェイ

インターネットとサブネットやサーバインスタンスは直接繋がっていません。よってVPCに通気口を開けるようなイメージで、VPC内外の接続点にインターネットゲートウェイを設置し、それをいわゆる関所とします。

インターネットから直接個々のサーバインスタンスへ繋がるようでは、セキュリティ設定等々を全てインスタンスごとに設定しなくてはいけません。また複数のインスタンスを立てるとなると、全てのインスタンスに同じ設定をしなくてはなりません。

インターネットゲートウェイが、VPC配下を守ってくれているようなイメージです。

### 2. VPCやサブネットの実装

ではこれより、実際にVPCやサブネットを実装していきましょう。もうここからはルートアカウントで作業せず、IAMで作った神アカウント「Administrator」でログインしてください。

コンソールよりVPCのサービスを開いてください。ここで再度、東京リージョンが選択されていることを確認しておきましょう。上図の赤枠の部分です。

＜図３：VPCサービスを開く＞

「VPCを作成する」ボタンをクリックしてください。

＜図４：ステップ１ VPC設定の選択＞

「選択する」ボタンをクリックしてください。

＜図５：ステップ２ 1個のパブリックサブネットを持つVPC＞

VPC名とサブネット名はわかりやすい名前なら結構ですが、もしうまくいかない時に質問を投稿することを考えて、できるだけ同じ内容を入力してください。入力し終えたら「VPCの作成」ボタンをクリックしてください。

＜図６：VPC作成完了＞

ほんの数秒後にはできました。左側のメニューに沿って順番に確認していきましょう。メニューの「VPC」をクリックしてください。

＜図７：VPC＞

できてますね。あと同様に、サブネットやインターネットゲートウェイも先にあげた全体像と見比べて確認しておいてください。

### まとめ

意外なほどに簡単にVPCとサブネットができたこと、体感していただけたでしょうか？次はいよいよVPC内にEC2インスタンスを立ち上げて、そこへ接続するまでを解説します。

